window.addEventListener("load",function(){startGame()},!1),startGame=function(){function t(t){if(y){var e=t.targetTouches?t.targetTouches[0].pageX:t.pageX,i=t.targetTouches?t.targetTouches[0].pageY:t.pageY;f===m.STATE_STARTUP||f===m.STATE_LOST?_.clicked(e,i):f===m.STATE_RUN&&(E.input.SPACE_PRESSED=!0)}}function e(t){this.frameIndex=0,this.tickCount=0,this.ticksPerFrame=t.ticksPerFrame||0,this.numberOfFrames=t.numberOfFrames||1,this.context=t.context,this.width=t.width,this.height=t.height,this.x=0,this.y=0,this.image=t.image,this.scaleRatio=1,this.update=function(){this.tickCount+=1,this.tickCount>this.ticksPerFrame&&(this.tickCount=0,this.frameIndex<this.numberOfFrames-1?this.frameIndex+=1:this.frameIndex=0)},this.render=function(){this.context.drawImage(this.image,this.frameIndex*this.width/this.numberOfFrames,0,this.width/this.numberOfFrames,this.height,this.x,this.y,this.width/this.numberOfFrames*this.scaleRatio,this.height*this.scaleRatio)},this.getFrameWidth=function(){return this.width/this.numberOfFrames}}function i(t){this.color=t,this.y=u.height-20}function s(t){this.color=t}function h(){this.input={},this.runner=new r(60,u.height-80,20,60,"#000000")}function n(t,e,i){this.x=t,this.y=e,this.sprite=i,this.sprite.x=t,this.sprite.y=e}function r(t,i,s,h,n){this.x=t,this.y=i,this.width=s,this.height=h,this.color=n,this.x_speed=0,this.y_speed=0,this.y_acc=1,this.img=new Image,this.img.src="/resources/default/1_0_0/img/games/fr/running.png",this.sprite=new e({context:u.getContext("2d"),width:370,height:60,image:this.img,numberOfFrames:8,ticksPerFrame:5}),this.sprite.x=t-15,this.sprite.y=i+10,this.hasDoubleJump=!0,this.current_state=w.STATE_RUNNING}function o(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.color=t.color,this.x_speed=t.x_speed,this.y_speed=0,this.update=function(t){this.x+=this.x_speed,this.y+=this.y_speed;{var e=this.x+this.width/2,i=this.y+this.height/2,s=(this.x,this.x+this.width),h=(this.y,this.y+this.height,t.x+t.width/2),n=t.y+t.height/2;t.x,t.x+t.width,t.y,t.y+t.height}2*Math.abs(h-e)<this.width+t.width&&2*Math.abs(n-i)<this.height+t.height&&(y?(_.message="YOU LOST! Final Score: "+T,_.message2=""):(_.message="YOU LOST! Hit 'ENTER' to restart.",_.message2="Final Score: "+T),f=m.STATE_LOST),2.5>=s&&(this.x=u.width-2.5,T++,T>S&&(S=T))},this.render=function(){p.fillStyle=this.color,p.fillRect(this.x,this.y,this.width,this.height),p.beginPath(),p.lineWidth=1,p.strokeStyle="#000000",p.rect(this.x+1,this.y,this.width-1,this.height),p.stroke()}}function a(t){o.call(this,t)}function d(t){o.call(this,t)}function c(){this.obstacleClass=a,this.createObstacle=function(t){switch(t.obstacleType){case"ground":this.obstacleClass=a;break;case"floating":this.obstacleClass=d}return new this.obstacleClass(t)}}function l(t,e,i){this.title=t,this.message="",this.message2="",this.width=e,this.height=i,this.buttonColor="#FAAAAA"}var u,p;u=document.getElementById("canvas"),p=u.getContext("2d");var g=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},m=Object.freeze({STATE_STARTUP:0,STATE_RUN:1,STATE_LOST:2}),w=Object.freeze({STATE_RUNNING:0,STATE_SLIDING:1,STATE_JUMPING:2}),f=m.STATE_STARTUP,T=0,S=0,y=!1,_=new l("Field Runner",400,240),A=new i("green"),b=new s("#33CCFF"),E=new h,x=new c,k=x.createObstacle({obstacleType:"ground",x:u.width-2.5,y:u.height-40,x_speed:-17,width:60,height:20,color:"#0000F0"}),v=x.createObstacle({obstacleType:"floating",x:u.width+u.width/2,y:u.height-60,x_speed:-10,width:60,height:20,color:"#F00000"}),R=new Image;R.src="/resources/default/1_0_0/img/games/fr/coin.png";var P=new n(u.width-40,10,new e({context:u.getContext("2d"),width:256,height:32,image:R,numberOfFrames:8,ticksPerFrame:5}));window.addEventListener("keydown",function(t){if(f===m.STATE_RUN)switch(t.keyCode){case 32:E.input.SPACE_PRESSED=!0,t.preventDefault();break;case 70:E.input.CTRL_PRESSED=!0,t.preventDefault()}else f===m.STATE_STARTUP?(I(),f=m.STATE_RUN,t.preventDefault()):f!==m.STATE_LOST||13!=t.keyCode&&32!=t.keyCode||(I(),f=m.STATE_RUN,t.preventDefault())}),window.addEventListener("keyup",function(t){70==t.keyCode&&(E.input.CTRL_RELEASED=!0)}),window.addEventListener("click",function(t){var e,i;t.offsetX?(e=t.offsetX,i=t.offsetY):t.layerX&&(e=t.layerX,i=t.layerY),(f===m.STATE_STARTUP||f===m.STATE_LOST)&&_.clicked(e,i)}),window.addEventListener("mousedown",function(t){var e,i;t.offsetX?(e=t.offsetX,i=t.offsetY):t.layerX&&(e=t.layerX,i=t.layerY),(f===m.STATE_STARTUP||f===m.STATE_LOST)&&_.mouseDown(e,i)}),window.addEventListener("touchstart",t),i.prototype.render=function(){p.fillStyle=this.color,p.fillRect(2,u.height-20,u.width-3,17.5),p.beginPath(),p.lineWidth=1,p.strokeStyle="#000000",p.moveTo(2.5,u.height-20),p.lineTo(u.width-2,u.height-20),p.stroke(),p.fillStyle=this.color},s.prototype.render=function(){p.beginPath(),p.lineWidth="5",p.strokeStyle="red",p.rect(0,0,u.width,u.height),p.stroke(),p.fillStyle=this.color,p.fillRect(2.5,2.5,u.width-5,u.height-5)},h.prototype.render=function(){this.runner.render()},h.prototype.update=function(){this.runner.handleInput(this.input),this.runner.update()},n.prototype.render=function(){this.sprite.render()},n.prototype.update=function(){this.sprite.update()},r.prototype.render=function(){this.sprite.render()},r.prototype.jump=function(){this.y_speed=-10,this.current_state=w.STATE_JUMPING},r.prototype.startSlide=function(){var t=this.width;this.width=this.height,this.height=t,this.y=A.y-this.height,this.x=5,this.img.src="/resources/default/1_0_0/img/games/fr/sliding.png",this.sprite.ticksPerFrame=1,this.sprite.numberOfFrames=1,this.sprite.width=60,this.sprite.height=46,this.current_state=w.STATE_SLIDING},r.prototype.endSlide=function(){var t=this.width;this.width=this.height,this.height=t,this.y=A.y-this.height,this.x=60,this.img.src="/resources/default/1_0_0/img/games/fr/running.png",this.sprite.ticksPerFrame=5,this.sprite.numberOfFrames=8,this.sprite.width=370,this.sprite.height=60,this.current_state=w.STATE_RUNNING},r.prototype.update=function(){this.y+=this.y_speed,this.y_speed+=this.y_acc,this.y+this.height>u.height-20&&(this.y_speed=0,this.y=A.y-this.height,this.current_state===w.STATE_JUMPING&&(this.hasDoubleJump=!0,this.current_state=w.STATE_RUNNING)),this.y<=2.5&&(this.y=2.5),this.current_state===w.STATE_SLIDING?(this.sprite.x=this.x,this.sprite.y=this.y-7):(this.sprite.x=this.x-15,this.sprite.y=this.y+10),this.sprite.update()},r.prototype.handleInput=function(t){for(var e in t){switch(this.current_state){case w.STATE_RUNNING:"SPACE_PRESSED"==e?(this.jump(),this.current_state=w.STATE_JUMPING,delete t[e]):"CTRL_PRESSED"==e&&(this.startSlide(),this.current_state=w.STATE_SLIDING,delete t[e]),delete t[e];break;case w.STATE_JUMPING:"SPACE_PRESSED"==e&&this.hasDoubleJump&&(this.jump(),this.current_state=w.STATE_JUMPING,delete t[e],this.hasDoubleJump=!1);break;case w.STATE_SLIDING:"CTRL_RELEASED"==e?(this.endSlide(),this.current_state=w.STATE_RUNNING,this.hasDoubleJump=!0,delete t[e]):"CTRL_PRESSED"==e?delete t[e]:"SPACE_PRESSED"==e&&(this.endSlide(),this.jump(),this.current_state=w.STATE_JUMPING,delete t[e]),delete t[e]}break}t={}},l.prototype.render=function(){p.beginPath(),p.lineWidth="5",p.strokeStyle="#0F0F0F",p.rect(u.width/2-this.width/2,u.height/2-this.height/2,this.width,this.height),p.stroke(),p.fillStyle="#FFFFAA",p.fillRect(u.width/2-this.width/2+2.5,u.height/2-this.height/2+2.5,this.width-5,this.height-5),p.fillStyle="#000000",p.font="40px Georgia",p.textAlign="center",p.fillText(this.title,u.width/2,u.height/2-60),p.font="20px Georgia",p.fillText(this.message,u.width/2,u.height/2-20),p.fillText(this.message2,u.width/2,u.height/2+12.5),p.beginPath(),p.lineWidth="5",p.strokeStyle="#0F0F0F",p.rect(u.width/2-60,u.height/2+35,120,60),p.stroke(),p.fillStyle=this.buttonColor,p.fillRect(u.width/2-60+2.5,u.height/2+37.5,115,55),p.fillStyle="#000000",p.font="20px Georgia",p.fillText("START",u.width/2,u.height/2+72)},l.prototype.clicked=function(t,e){t>=u.width/2-60&&t<=u.width/2+60&&e>=u.height/2+35&&e<=u.height/2+95&&(I(),f=m.STATE_RUN),this.buttonColor="#FAAAAA"},l.prototype.mouseDown=function(t,e){this.buttonColor=t>=u.width/2-60&&t<=u.width/2+60&&e>=u.height/2+35&&e<=u.height/2+95?"#FAFAFA":"#FAAAAA"};var F=function(){b.render(),A.render()},N=function(){p.fillStyle="#000000",p.font="20px Georgia",p.textAlign="left",p.fillText("Score: "+T,10,25),p.fillText("Highest: "+S,8,45)};window.mobilecheck=function(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t};var U=function(){y=window.mobilecheck(),y?(_.message="TAP anywhere once to JUMP",_.message2="TAP anywhere twice to DOUBLE JUMP"):(_.message="Hit 'SPACE' to JUMP, 'F' to SLIDE",_.message2="Hit 'SPACE' twice to DOUBLE JUMP"),g(C)},I=function(){T=0,k.x=u.width-2.5+500,v.x=u.width+u.width/2+430},C=function(){L(),D(),g(C)},L=function(){P.update(),f===m.STATE_RUN&&(E.update(),k.update(E.runner),v.update(E.runner))},D=function(){F(),N(),S>=100&&P.render(),f===m.STATE_STARTUP?_.render():f===m.STATE_RUN?(k.render(),v.render(),E.render()):f===m.STATE_LOST&&(k.render(),v.render(),E.render(),_.render())};U()};